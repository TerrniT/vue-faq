import{d as $,h as _,l as S,R as C,o as r,c as i,m as l,t as d,p as v,F as w,D as T,Q as M,I as x,n as f,e as b,b as U,U as j}from"./framework.P5TqXf0g.js";const z=["href"],B={class:"avatar"},I=["src"],A={class:"username"},E=$({__name:"UserBadge",props:{username:{}},setup(s){return(t,e)=>(r(),i("a",{href:`https://github.com/${t.username}`,rel:"noopener noreferrer",target:"_blank",class:"user"},[l("span",B,[l("img",{src:`https://github.com/${t.username}.png`,alt:""},null,8,I)]),l("span",A,d(t.username),1)],8,z))}}),F={class:"issue-tabs"},V=["onClick"],N={key:0},P={class:"mobile-only tab-title"},O={class:"not-mobile-only tab-title"},R=["innerHTML"],q=["href"],Y=["innerHTML"],G={key:0},Q=["href"],W=["innerHTML"],J={key:0},K=$({__name:"TimelineItemIssues",props:{release:{},options:{}},setup(s){const t=s,e=_(""),a=_(),c=_(0),h=[{name:"desc",title:"Desc",mobileTitle:"Desc",show:t.options.display.release.desc},{name:"pulls",title:"Pull Requests",mobileTitle:"Pulls",show:t.options.display.release.pulls},{name:"commits",title:"Commits",mobileTitle:"Commits",show:t.options.display.release.commits}];t.options.display.release.defaultOpenTab&&(e.value=t.options.display.release.defaultOpenTab);function p(o){e.value=o===e.value?"":o,C(()=>{var y;c.value=(y=a.value)==null?void 0:y.scrollHeight})}return(o,y)=>(r(),i(w,null,[l("div",F,[(r(),i(w,null,T(h,n=>l("button",{key:n.name,class:f(["tab",{active:e.value===n.name}]),onClick:m=>p(n.name)},[n.show?(r(),i("span",N,[l("span",P,d(n.mobileTitle),1),l("span",O,d(n.title),1)])):b("",!0)],10,V)),64))]),l("div",{ref_key:"issuesSection",ref:a,class:f(["issues",e.value]),style:M({maxHeight:e.value===""?0:`${c.value}px`})},[o.release.desc?(r(),i("section",{key:0,class:f({open:e.value==="desc"})},[l("div",{class:"issue",innerHTML:o.release.desc},null,8,R)],2)):b("",!0),l("section",{class:f({open:e.value==="pulls"})},[(r(!0),i(w,null,T(o.release.pulls,n=>(r(),i("div",{key:n.number,class:"issue-wrapper"},[l("a",{href:`https://github.com/${o.options.github.owner}/${o.options.github.repo}/pull/${n.number}`,rel:"noopener noreferrer",target:"_blank",class:"issue"},[l("p",null,[l("span",null," #"+d(n.number)+": ",1),l("span",{innerHTML:n.title},null,8,Y),o.options.display.release.hidePullUsername?b("",!0):(r(),i("span",G," - @"+d(n.author),1))])],8,q)]))),128))],2),l("section",{class:f({open:e.value==="commits"})},[(r(!0),i(w,null,T(o.release.commits,n=>(r(),i("div",{key:n.url,class:"issue-wrapper"},[!o.options.display.release.hideMergeCommits||!n.title.startsWith("Merge ")?(r(),i("a",{key:0,href:n.url,rel:"noopener noreferrer",target:"_blank",class:"issue"},[l("p",null,[l("span",{innerHTML:n.title},null,8,W),o.options.display.release.hideCommitUsername?b("",!0):(r(),i("span",J," - @"+d(n.author),1))])],8,Q)):b("",!0)]))),128))],2)],6)],64))}}),X={class:"timeline-item"},Z=l("div",{class:"circle"},null,-1),ee={class:"content"},se=["datetime"],te=["href"],ae={key:0,class:"release-name"},le=$({__name:"TimelineItem",props:{release:{},options:{}},setup(s){function t(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}return(e,a)=>(r(),i("div",X,[Z,l("div",ee,[l("time",{datetime:e.release.published_at},d(t(e.release.published_at)),9,se),l("a",{href:`https://github.com/${e.options.github.owner}/${e.options.github.repo}/releases/tag/${e.release.tag_name}`,rel:"noopener noreferrer",target:"_blank",class:"tag-name"},d(e.release.tag_name),9,te),e.options.display.release.name?(r(),i("h2",ae,d(e.release.name),1)):b("",!0),e.options.display.release.username?(r(),U(E,{key:1,username:e.release.author},null,8,["username"])):b("",!0),x(K,{release:e.release,options:e.options},null,8,["release","options"])])]))}});function ne(s,t){return s.getDate()===t.getDate()&&s.getMonth()===t.getMonth()&&s.getFullYear()===t.getFullYear()}function re(s,t){const e=[],a=new Date(s);for(a.setHours(0,0);a<=t;)e.push(new Date(a)),a.setDate(a.getDate()+1);return e}async function ie(s){let t={};const e=new Map;for(const m in["releases","pulls","commits"]){const u=["releases","pulls","commits"][m];let g;s.github[u].feedType==="github"?(g=`https://api.github.com/repos/${s.github.owner}/${s.github.repo}/${u}?per_page=${s.github[u].size}&state=closed`,s.github.token&&(t={Authorization:`token ${s.github.token}`})):g=s.github[u].url;const k=await fetch(g,{headers:t}).then(D=>D.json());e.set(u,k)}const a=e.get("releases"),c=e.get("pulls"),h=e.get("commits"),p=a[a.length-1],o=re(new Date(p.published_at),new Date),y=new Date(a[0].published_at).getTime()-new Date(a[a.length-1].published_at).getTime(),n=new Set;return o.reverse().forEach(m=>{a.filter(u=>ne(new Date(u.published_at),m)).forEach(u=>{n.add({day:m,release:u})})}),[...n].map((m,u)=>{const g=new Date(m.release.published_at),k=u===a.length-1?new Date(1980,1):new Date(a[u+1].published_at),D=u===0?null:new Date(a[u-1].published_at),L=u===0?s.timeline.paddingTop:u<a.length-1?(D.getTime()-g.getTime())/y:0;return{day:m.day,release:{name:m.release.name,tag_name:m.release.tag_name,published_at:m.release.published_at,author:m.release.author.login,desc:oe(m.release.body),pulls:ue(k,g,c),commits:ce(k,g,h)},diff:L}})}function oe(s){if(!s)return"";s=s.replaceAll("</samp>","").replaceAll("<samp>","");const t=/\[([^\]]+)\]\(([^)]+)\)/g;s=s.replace(/</g,"&lt;").replace(/>/g,"&gt;"),s=s.replace(t,'<a href="$2" target="_blank">$1</a>');const e=/^(#+)\s(.+)/gm;return s=s.replace(e,(a,c,h)=>{const p=c.length;return`<h${p}>${h}</h${p}>`}),s=s.split(`\r
`).filter(a=>a).map(a=>a.trim()).join("</p><p>"),s}function ue(s,t,e){return e.filter(a=>{const c=new Date(a.closed_at);return c>=s&&c<=t}).map(a=>({title:a.title.replace(/[feat|chore|fix|refactor|docs|style|test|revert|bump](.*?)\:/,"<i>$&</i>"),number:a.number,author:a.user.login}))}function ce(s,t,e){return e.filter(a=>{const c=new Date(a.commit.author.date);return c>=s&&c<=t}).map(a=>({title:a.commit.message.replace(/[feat|chore|fix|refactor|docs|style|test|revert|bump](.*?)\:/,"<i>$&</i>"),url:a.html_url,author:a.author.login}))}function H(s,t){for(const e in t)typeof t[e]=="object"&&t[e]!==null&&!Array.isArray(t[e])?(e in s||(s[e]={}),H(s[e],t[e])):s[e]=t[e];return s}const pe={title:"Releases",github:{owner:"vuejs",repo:"vitepress",token:"",releases:{feedType:"github",url:"/releases.json",size:20},pulls:{feedType:"github",url:"pulls.json",size:100},commits:{feedType:"github",url:"commits.json",size:200}},timeline:{paddingTop:.1,span:200},display:{animatedBackground:!0,animatedBackgroundForLightTheme:!1,release:{name:!0,username:!0,desc:!0,pulls:!0,commits:!0,hidePullUsername:!1,hideCommitUsername:!0,hideMergeCommits:!0}}},me=l("div",{id:"stars",class:"bg-stars"},null,-1),he=l("div",{id:"stars2",class:"bg-stars"},null,-1),de=l("div",{id:"stars3",class:"bg-stars"},null,-1),ge={class:"header"},be=["href"],fe=j('<div class="github-link"><div class="github-icon" aria-hidden="true"><svg width="24" height="24" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path fill="currentColor" d="M16 .396c-8.839 0-16 7.167-16 16c0 7.073 4.584 13.068 10.937 15.183c.803.151 1.093-.344 1.093-.772c0-.38-.009-1.385-.015-2.719c-4.453.964-5.391-2.151-5.391-2.151c-.729-1.844-1.781-2.339-1.781-2.339c-1.448-.989.115-.968.115-.968c1.604.109 2.448 1.645 2.448 1.645c1.427 2.448 3.744 1.74 4.661 1.328c.14-1.031.557-1.74 1.011-2.135c-3.552-.401-7.287-1.776-7.287-7.907c0-1.751.62-3.177 1.645-4.297c-.177-.401-.719-2.031.141-4.235c0 0 1.339-.427 4.4 1.641a15.436 15.436 0 0 1 4-.541c1.36.009 2.719.187 4 .541c3.043-2.068 4.381-1.641 4.381-1.641c.859 2.204.317 3.833.161 4.235c1.015 1.12 1.635 2.547 1.635 4.297c0 6.145-3.74 7.5-7.296 7.891c.556.479 1.077 1.464 1.077 2.959c0 2.14-.02 3.864-.02 4.385c0 .416.28.916 1.104.755c6.4-2.093 10.979-8.093 10.979-15.156c0-8.833-7.161-16-16-16z"></path></svg></div><div class="github-title">View on GitHub</div></div>',1),ye=[fe],ve={class:"timeline"},we=l("div",{class:"line"},null,-1),ke=$({__name:"ReleaseTimeline",props:{options:{}},setup(s){const t=H(pe,s.options),e=_(),a=_();return S(async()=>{e.value=await ie(t);const c=new IntersectionObserver(h=>{h.forEach(p=>{p.isIntersecting&&(p.target.style.opacity="1")})},{threshold:.5});C(()=>{a.value.querySelectorAll(".timeline .rt-tr-el").forEach(h=>{c.observe(h)})})}),(c,h)=>(r(),i("section",{ref_key:"root",ref:a,class:"release-timeline"},[me,he,de,l("header",ge,[l("h1",null,d(v(t).title),1),l("a",{href:`https://github.com/${v(t).github.owner}/${v(t).github.repo}/releases`,rel:"noopener noreferrer",target:"_blank"},ye,8,be)]),l("div",ve,[(r(!0),i(w,null,T(e.value,(p,o)=>(r(),i("section",{key:p.day.getUTCDate(),class:"timeline-record rt-tr-el",style:M({paddingTop:`${p.diff*v(t).timeline.span}px`})},[we,x(le,{release:p.release,options:v(t),class:f(o%2===1?"left":"right")},null,8,["release","options","class"])],4))),128))])],512))}});export{pe as j,ke as k};
